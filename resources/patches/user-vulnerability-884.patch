--- modules/user/user.module	2013-08-13 11:49:21.072795138 +0200
+++ modules/user/user.module	2013-08-13 11:53:01.628022005 +0200
@@ -2187,15 +2187,21 @@
 
     if (isset($form_state['flood_control_triggered'])) {
       if ($form_state['flood_control_triggered'] == 'user') {
-        form_set_error('name', format_plural(variable_get('user_failed_login_user_limit', 5), 'Sorry, there has been more than one failed login attempt for this account. It is temporarily blocked. Try again later or <a href="@url">request a new password</a>.', 'Sorry, there have been more than @count failed login attempts for this account. It is temporarily blocked. Try again later or <a href="@url">request a new password</a>.', array('@url' => url('user/password'))));
+        //Standardise the error message to not disclose policy to bruteforcers
+        form_set_error('name', t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
+
       }
       else {
         // We did not find a uid, so the limit is IP-based.
-        form_set_error('name', t('Sorry, too many failed login attempts from your IP address. This IP address is temporarily blocked. Try again later or <a href="@url">request a new password</a>.', array('@url' => url('user/password'))));
+        //Standardise the error message to not disclose policy to bruteforcers
+        form_set_error('name', t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
+
       }
     }
     else {
-      form_set_error('name', t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>', array('@password' => url('user/password', array('query' => array('name' => $form_state['values']['name']))))));
+      //Standardise the error message to not disclose policy to bruteforcers
+      form_set_error('name', t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
+
       watchdog('user', 'Login attempt failed for %user.', array('%user' => $form_state['values']['name']));
     }
   }
--- modules/user/user.test.old  2015-11-05 10:53:44.042710768 +0100
+++ modules/user/user.test  2015-11-05 10:52:33.000000000 +0100
@@ -438,15 +438,15 @@
     $this->assertNoFieldByXPath("//input[@name='pass' and @value!='']", NULL, 'Password value attribute is blank.');
     if (isset($flood_trigger)) {
       if ($flood_trigger == 'user') {
-        $this->assertRaw(format_plural(variable_get('user_failed_login_user_limit', 5), 'Sorry, there has been more than one failed login attempt for this account. It is temporarily blocked. Try again later or <a href="@url">request a new password</a>.', 'Sorry, there have been more than @count failed login attempts for this account. It is temporarily blocked. Try again later or <a href="@url">request a new password</a>.', array('@url' => url('user/password'))));
+      $this->assertRaw(t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
       }
       else {
         // No uid, so the limit is IP-based.
-        $this->assertRaw(t('Sorry, too many failed login attempts from your IP address. This IP address is temporarily blocked. Try again later or <a href="@url">request a new password</a>.', array('@url' => url('user/password'))));
+      $this->assertRaw(t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
       }
     }
     else {
-      $this->assertText(t('Sorry, unrecognized username or password. Have you forgotten your password?'));
+      $this->assertRaw(t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
     }
   }
 }
@@ -512,8 +512,7 @@
       'pass' => $this->randomName(),
     );
     $this->drupalPost('user', $edit, t('Log in'));
-    $this->assertRaw(t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>',
-      array('@password' => url('user/password', array('query' => array('name' => $edit['name']))))));
+    $this->assertRaw( t('Sorry, unrecognized username or password. <a href="@password">Have you forgotten your password?</a>. If you made too many attempts your IP address has been blocked and you will not be able to login even with a new password. Please contact your administrator.', array('@password' => url('user/password'))));
     unset($edit['pass']);
     $this->drupalGet('user/password', array('query' => array('name' => $edit['name'])));
     $this->assertFieldByName('name', $edit['name'], 'User name found.');

