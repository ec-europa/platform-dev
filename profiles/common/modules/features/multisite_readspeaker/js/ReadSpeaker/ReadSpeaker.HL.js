rspkr.HL=function(){var c="",b={firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[]},f={oldWordHL:[],oldWordHLClass:[],oldSentHL:[],oldSentHLClass:[],sync:function(a,d){var c=!1,b=document.getElementById("sync"+d);0==(a&2)&&(c=0!=(a&1)?!0:!1);if(b&&b.className.replace("word","")!=b.className){if(!c&&0<this.oldWordHL.length){for(c=0;c<this.oldWordHLClass.length;c++)this.oldWordHL[c].className=this.oldWordHLClass[c];this.oldWordHL=[];this.oldWordHLClass=
[]}this.oldWordHLClass.push(b.className);this.oldWordHL.push(b);b.className="sync_word_highlighted"}else if(b&&b.className.replace("sent","")!=b.className){if(!c&&0<this.oldSentHL.length){for(c=0;c<this.oldSentHL.length;c++)this.oldSentHL[c].className=this.oldSentHLClass[c];this.oldSentHL=[];this.oldSentHLClass=[]}this.oldSentHLClass.push(b.className);this.oldSentHL.push(b);b.className="sync_sent_highlighted"}b&&rspkr.HL.Scroll.execScroll(b)},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");
var a=rspkr.Common.data.getParam("readid"),a=document.getElementById(a).innerHTML;rspkr.Common.data.setRestoreContent(a)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!");rspkr.HL.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");var a=rspkr.HL.serverMarkup.oldWordHL,d=rspkr.HL.serverMarkup.oldWordHLClass,c=rspkr.HL.serverMarkup.oldSentHL,b=rspkr.HL.serverMarkup.oldSentHLClass;if(0<a.length){for(var g=
0;g<a.length;g++)a[g].className=d[g];rspkr.HL.serverMarkup.oldWordHL=[];rspkr.HL.serverMarkup.oldWordHLClass=[]}if(0<c.length){for(g=0;g<c.length;g++)c[g].className=b[g];rspkr.HL.serverMarkup.oldSentHL=[];rspkr.HL.serverMarkup.oldSentHLClass=[]}a=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer);for(g=a.length-1;-1<g;g--)a[g].className=a[g].className.replace("sync_sent_highlighted","sync_sent"),a[g].className=a[g].className.replace("sync_word_highlighted","sync_word"),-1!==a[g].className.toLowerCase().indexOf("sync_user")&&
(a[g].className=a[g].className.replace("sync_sent",""),a[g].className=a[g].className.replace("sync_word",""),a[g].removeAttribute("id"))}}},e={enums:{key:"readspeaker_inline_styles",sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted"},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var a=rspkr.pub.Config,d=rspkr.Common.Settings.get("hlword")||a.item("settings.hlword"),a=rspkr.Common.Settings.get("hlsent")||a.item("settings.hlsent");this.updateHL("hlword",
d,null);this.updateHL("hlsent",a,null)},updateHL:function(a,d,c){"hlspeed"===a&&d!==c&&(this.hlChanged=!0);if(d!==c&&("hl"===a||"hltoggle"===a))this.hlChanged=!0,rspkr.HL.sync.lightCleanUp();if(d!==c&&("hl"===a&&"none"!==d||"hltoggle"===a&&"hlon"===d))this.setTextStyle("word",rspkr.Common.Settings.get("hlword")),this.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),this.hlChanged=!0,rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&rspkr.PlayerAPI.releaseAdapter();/hlword|hlsent|hlscroll/i.test(a)&&
d!=c&&("hlscroll"==a?rspkr.HL.Scroll.initScroll():this.setTextStyle(a,d))},setTextStyle:function(a,d,c){var b=/word/.test(a)?"word":"sent",a="background-color",c=c||e.enums.key;/underline/.test(d)?(a="text-decoration",d+=" !important; color: none !important; background-color: none !important"):/none/.test(d)?(a="background",d+=" !important; text-decoration: none !important; background-color: none !important"):d+=" !important; text-decoration: none !important";rspkr.Common.css.replaceRule(c,"."+e.enums[b+
"_hl"],a+": "+d+"")}};return{meta:{revision:"1316"},init:function(){var a=rspkr.Common.addEvent;a("onAfterModsLoaded",function(){a("onAPIInitAdapter",rspkr.HL.Restore.setRestoreContent);rspkr.HL.addEvents();rspkr.HL.Scroll.initScroll();c=document.selection&&9>rspkr.Common.data.browser.version?"explorer":"gecko";rspkr.log("[rspkr.hl] Using engine "+c);var d=rspkr.HL.engine[c].clientExtension,e;for(e in d)b[e]=d[e];window.addEventListener&&window.addEventListener("message",rspkr.HL.html5.receiveMessage,
!1,!0)});a("onModsLoaded",{func:e.setHL,context:e});a("onSettingsChanged",{func:e.updateHL,context:e});rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){rspkr.log("[rspkr.HL.addEvents]");evt("onUIClosePlayer",rspkr.HL.cleanUpHandler);evt("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)});evt("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)});evt("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()});rspkr.PlayerAPI&&(rspkr.PlayerAPI.adapter&&
"html5"===rspkr.PlayerAPI.adapter)&&(rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release));rspkr.evt("onAPIStop",rspkr.HL.sync.lightCleanUp)},cleanUpHandler:function(a){rspkr.log("[rspkr.HL.cleanUpHandler] String is: "+
a);"userclick"===a||"nosel"===a?rspkr.HL.sync.fullCleanUp():rspkr.HL.sync.lightCleanUp()},clientMarkup:b,serverMarkup:f,markedUpHTML:"",html5:{States:{BEGIN:0,STOPPED:1,USER_START_NOT_READY:2,USER_START_PLAYING:3,NOT_PLAYING:4,CURRENT:0,setState:function(a){this.CURRENT=a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,audioUrl:null,
backupUrl:null,frameUrl:null,timer:null,postMessageData:[],runningRefresh:!1,handlers:{init:function(){rspkr.log("[rspkr.HL.html5.handlers.init]");var a=Math.random(),d={};d.audioformat=rspkr.Common.data.browser.html5AudioFormat;d.requestgrouptype="html5iframe";d.requestgroup=a;rspkr.HL.html5.backupUrl=rspkr.Common.data.getAudioLink(d);(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)&&"iOS"!==rspkr.Common.data.browser.OS&&"Android"!==
rspkr.Common.data.browser.OS?rspkr.HL.html5.timer=setTimeout(function(){rspkr.HL.html5.initSyncFrame(d);rspkr.HL.html5.initAudio();clearTimeout(rspkr.HL.html5.timer)},2E3):(rspkr.log("Normal audio init!"),rspkr.HL.html5.initSyncFrame(d),rspkr.HL.html5.initAudio())},play:function(){rspkr.log("[rspkr.HL.html5.handlers.play]");rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),
rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.html5.handlers.updateTime()},pause:function(){rspkr.hl.State.CURRENT==rspkr.hl.State.PLAYING&&rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING)},
release:function(){rspkr.log("[rspkr.HL.html5.handlers.release]");rspkr.HL.html5.synclist=[];rspkr.HL.html5.synclistindex=0;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.audioUrl=null;rspkr.HL.html5.backupUrl=null;rspkr.HL.html5.frameUrl=null;rspkr.HL.html5.postMessageData=[];rspkr.PlayerAPI.playerRef.removeEventListener("ended",rshlexit,!1);rspkr.PlayerAPI.playerRef=null;var a=document.getElementById("ReadSpeaker_sync_iframe");a&&(a.src="about:blank")},stop:function(){rspkr.log("[rspkr.HL.html5.handlers.stop]",
5);rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED);rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.HL.html5.handlers.updateTime]");rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.HL.html5.lastcurrenttime=rspkr.PlayerAPI.playerRef.currentTime;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.handlers.setCurrentSyncIndex();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.runPostMessages]");
var a=rspkr.HL.html5.postMessageData,d;for(d in a)null!==a[d-1]&&"rshlsetContent"==a[d]?rspkr.HL.sync.setContent(rspkr.Common.base64.decode(a[d-1])):null!==a[d-1]&&"rshlsetId"==a[d]?rspkr.HL.sync.setId(a[d-1]):"rshlinit"==a[d]&&(rspkr.HL.sync.init(),rspkr.PlayerAPI.playerRef.play(),rspkr.HL.html5.refresh())},setCurrentSyncIndex:function(){if(0<rspkr.HL.html5.synclist.length&&rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex])for(;20>=1*rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex][0]-
1E3*rspkr.PlayerAPI.playerRef.currentTime;)rspkr.HL.html5.currentsyncindex++},totalTime:function(){var a=rspkr.PlayerAPI.playerRef;if(a)if("Opera"!==rspkr.Common.data.browser.name&&a.buffered&&a.buffered.end)try{return 0<a.buffered.length?a.buffered.end(a.buffered.length-1):a.buffered.end(0)}catch(d){return a.duration&&"infinity"!==a.duration.toString().toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}else return a.duration&&"infinity"!==a.duration.toString.toLowerCase()&&"NaN"!==a.duration?
a.duration:a.currentTime+15}},initAudio:function(){rspkr.HL.html5.audioUrl||(rspkr.HL.html5.audioUrl=rspkr.HL.html5.backupUrl);rspkr.log("[rspkr.html5.initAudio] Audio URL: "+rspkr.HL.html5.audioUrl);rspkr.PlayerAPI.playerRef=new Audio(rspkr.HL.html5.audioUrl);var a=rspkr.PlayerAPI.playerRef;a.setAttribute("controls","controls");a.loop=!1;if("iOS"===rspkr.Common.data.browser.OS||"Android"===rspkr.Common.data.browser.OS)rspkr.PlayerAPI.playerRef.play(),rspkr.PlayerAPI.playerRef.pause();a.addEventListener("durationchange",
function(){rspkr.log("[rspkr.hl] totalTime: "+rspkr.HL.html5.handlers.totalTime());1==rspkr.HL.html5.handlers.totalTime()&&!0==rspkr.PlayerAPI.playerRef.paused?rspkr.HL.html5.initAudio():(1<rspkr.HL.html5.handlers.totalTime()&&!1===rspkr.HL.html5.runningRefresh?(rspkr.PlayerAPI.playerRef.play(),rspkr.HL.html5.refresh()):!1===rspkr.HL.html5.runningRefresh&&(rspkr.PlayerAPI.playerRef.play(),rspkr.HL.html5.refresh()),rspkr.PlayerAPI.playerRef.addEventListener("ended",function(){window.rshlexit("false")},
!1))},!1);rspkr.pl.checkNetworkStatus();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},initSyncFrame:function(a){if("none"!=rspkr.Common.data.sync){var d=null;document.getElementById("ReadSpeaker_sync_iframe")?d=document.getElementById("ReadSpeaker_sync_iframe"):(d=document.createElement("iframe"),d.setAttribute("id","ReadSpeaker_sync_iframe"));!rspkr.HL.html5.frameUrl&&(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)?
rspkr.HL.html5.frameUrl=rspkr.HL.html5.backupUrl+"sync":rspkr.HL.html5.frameUrl||(a.audioformat="html5iframe",rspkr.HL.html5.frameUrl=rspkr.Common.data.getAudioLink(a));rspkr.log("[rspkr.HL.html5.initSyncFrame] Audio URL: "+rspkr.HL.html5.frameUrl);d.src=rspkr.HL.html5.frameUrl;d.type="text/javascript";d.height=0;d.width=0;d.style.display="none";document.body.appendChild(d)}else rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.PlayerAPI.playerRef.play()},receiveMessage:function(a){a.origin.match(/readspeaker.?.com/gi)&&
(rspkr.HL.html5.postMessageData.push(a.data),!/android|ios/i.test(rspkr.Common.data.browser.OS)&&"rshlfinished"==a.data&&(rspkr.HL.html5.timer&&clearTimeout(rspkr.HL.html5.timer),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio()),-1!=a.data.indexOf(rspkr.Common.data.browser.html5AudioFormat)?rspkr.HL.html5.audioUrl=a.data:-1!=a.data.indexOf(".html5iframe")?rspkr.HL.html5.frameUrl=a.data:"rshlaudio"!=a.data&&"rshlhtml5sync"!=a.data&&(null!=rspkr.HL.html5.lastevent&&"rshlsetContent"==a.data?
(rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.sync.setContent(rspkr.Common.base64.decode(rspkr.HL.html5.lastevent.data))):null!=rspkr.HL.html5.lastevent&&"rshlsetId"==a.data?rspkr.HL.sync.setId(rspkr.HL.html5.lastevent.data):"rshlinit"==a.data?(rspkr.HL.sync.init(),!1===rspkr.HL.html5.runningRefresh&&(rspkr.PlayerAPI.playerRef.play(),rspkr.HL.html5.refresh())):null!=rspkr.HL.html5.lastlastlastevent&&(null!=rspkr.HL.html5.lastlastevent&&null!=rspkr.HL.html5.lastevent&&"rshlsync"==
a.data)&&(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastlastlastevent.data,rspkr.HL.html5.lastlastevent.data,rspkr.HL.html5.lastevent.data],rspkr.HL.html5.synclistindex++),rspkr.HL.html5.lastlastlastevent=rspkr.HL.html5.lastlastevent,rspkr.HL.html5.lastlastevent=rspkr.HL.html5.lastevent,rspkr.HL.html5.lastevent=a))},refresh:function(){var a=rspkr.PlayerAPI.playerRef,d=rspkr.HL.html5;if(!a||d.States.CURRENT==d.States.STOPPED)d.runningRefresh=!1;else if(d.States.CURRENT==
d.States.NOT_PLAYING&&setTimeout(function(){d.refresh()},500),0<a.currentTime&&parseInt(d.lastcurrenttime)>parseInt(a.currentTime))rspkr.PlayerAPI.stop(),d.runningRefresh=!1;else if(d.lastcurrenttime=a.currentTime,d.runningRefresh=!0,d.States.CURRENT==d.States.BEGIN){if(1<d.handlers.totalTime()&&15!==d.handlers.totalTime()){try{a.pause()}catch(c){rspkr.log(c,3)}rspkr.hl.html5.States.setState(d.States.USER_START_NOT_READY)}else a.play();setTimeout(function(){d.refresh()},200)}else d.States.CURRENT==
d.States.USER_START_NOT_READY?d.synclist[d.currentsyncindex]&&1<d.handlers.totalTime()&&d.synclist[d.currentsyncindex][0]<1E3*d.handlers.totalTime()?(rspkr.hl.html5.States.setState(d.States.USER_START_PLAYING),a.play(),setTimeout(function(){d.refresh()},0)):d.synclist[d.currentsyncindex]?20>=1*d.synclist[d.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){d.refresh()},0):(a=1*d.synclist[d.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){d.refresh()},75):0>a?setTimeout(function(){d.refresh()},
0):setTimeout(function(){d.refresh()},a)):setTimeout(function(){d.refresh()},75):d.States.CURRENT==d.States.USER_START_PLAYING&&(d.synclist[d.currentsyncindex]&&1*d.synclist[d.currentsyncindex][0]-20<1E3*a.currentTime&&(rspkr.HL.sync.execute(d.synclist[d.currentsyncindex][1],d.synclist[d.currentsyncindex][2]),d.currentsyncindex++),d.synclist[d.currentsyncindex]?20>=1*d.synclist[d.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){d.refresh()},0):(a=1*d.synclist[d.currentsyncindex][0]-1E3*
a.currentTime-20,75<a?setTimeout(function(){d.refresh()},75):0>a?setTimeout(function(){d.refresh()},0):setTimeout(function(){d.refresh()},a)):setTimeout(function(){d.refresh()},75))}},Preserve:{cls:"rs_preserve",testElem:null,elementShelter:[],formShelter:[],formData:function(a,d,c,b,g){this.name=a;this.type=d;this.value=c;this.checked=b;this.selectedIndex=g;this.selectedOptions=[]},moveToShelter:function(a){rspkr.log("[rspkr.HL.Preserve.moveToShelter]");var d=[],c=[],b=null,g;(g=$rs.findIn(a,"."+
rspkr.HL.Preserve.cls))&&!$rs.isArray(g)&&(g=[g]);for(var e=0,f=g.length;e<f;e++)b=$rs.get(g[e]).cloneNode(!1),g[e].parentNode.insertBefore(b,g[e]),d.push($rs.detach(g[e]));rspkr.log("[rspkr.hl.Preserve] Moved "+e+" nodes to the shelter.");a=$rs.findIn(a,"input, select");for(e=0;e<a.length;e++){b=new rspkr.HL.Preserve.formData(a[e].name,a[e].type,a[e].value,a[e].checked,a[e].selectedIndex);if("select-multiple"==a[e].type){g=a[e].options;for(var f=[],p=0;p<g.length;p++)f.push(g[p].selected);b.selectedOptions=
f}c.push(b)}rspkr.HL.Preserve.elementShelter.push(d);rspkr.HL.Preserve.formShelter.push(c)},restoreFromShelter:function(a){var d,c,b;rspkr.log("[rspkr.HL.Preserve.restoreFromShelter]");if(rspkr.HL.Preserve.elementShelter.length&&(b=rspkr.HL.Preserve.elementShelter.shift(),b.length)){(d=$rs.findIn(a,"."+rspkr.HL.Preserve.cls))&&!$rs.isArray(d)&&(d=[d]);for(var g=0,e=d.length;g<e;g++)c=b.shift(),d[g].parentNode.insertBefore(c,d[g]),d[g].parentNode.removeChild(d[g])}if(rspkr.HL.Preserve.formShelter.length&&
(a=$rs.findIn(a,"input, select"),d=rspkr.HL.Preserve.formShelter.shift(),a.length&&d.length&&a.length===d.length))for(g=0;g<a.length;g++)if(a[g].name===d[g].name)switch(a[g].type){case "text":a[g].value=d[g].value;break;case "password":a[g].value=d[g].value;break;case "radio":!0===d[g].checked&&(a[g].checked=!0);break;case "checkbox":a[g].checked=d[g].checked;break;case "select-one":a[g].selectedIndex=d[g].selectedIndex;break;case "select-multiple":c=a[g].options;for(b=0;b<c.length;b++)c[b].selected=
d[g].selectedOptions[b]}},clearShelter:function(){rspkr.log("[rspkr.HL.Preserve.clearShelter]");rspkr.HL.Preserve.elementShelter=[];rspkr.HL.Preserve.formShelter=[]}},Restore:{Storage:{readClass:[],readId:[],restoreContent:[]},all:function(){rspkr.log("[rspkr.HL.Restore.all]");var a=rspkr.HL.Restore.Storage,d=[],d=null,c=/sync_(word|sent)/gi;if(0<a.readId.length&&0<a.restoreContent.length)for(var b=0;b<a.readId.length;b++)for(var e=0;e<a.readId[b].length;e++)d=$rs.get("#"+a.readId[b][e]),!0===c.test(d.innerHTML)&&
(rspkr.HL.Preserve.moveToShelter(d),d.innerHTML=a.restoreContent[b][e],rspkr.HL.Preserve.restoreFromShelter(d));else if(0<a.readClass.length&&0<a.restoreContent.length)for(b=0;b<a.readClass.length;b++){rspkr.HL.Preserve.clearShelter();d=$rs.get("."+a.readClass[b]);for(e=0;e<d.length;e++)!0===c.test(d[e].innerHTML)&&(rspkr.HL.Preserve.moveToShelter(d[e]),d[e].innerHTML=a.restoreContent[b][e],rspkr.HL.Preserve.restoreFromShelter(d[e]))}else rspkr.log("No stored content exists!",2)},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",
1);!1===this.hasMarkup()&&(rspkr.hl.State.CURRENT==rspkr.hl.State.STOPPED&&rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP)&&(this.clearRestoreContent(),this.setRestoreContent(),rspkr.pl.releaseAdapter(),rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},hasMarkup:function(){var a=rspkr.HL.Restore.Storage,d=[],d=null,c=/sync_(word|sent)/gi;if(0<a.readId.length&&0<a.restoreContent.length)for(var b=0;b<a.readId.length;b++)for(var e=0;e<a.readId[b].length;e++){if(d=$rs.get("#"+a.readId[b][e]),!0===
c.test(d.innerHTML))return!0}else if(0<a.readClass.length&&0<a.restoreContent.length)for(b=0;b<a.readClass.length;b++){rspkr.HL.Preserve.clearShelter();d=$rs.get("."+a.readClass[b]);for(e=0;e<d.length;e++)if(!0===c.test(d[e].innerHTML))return!0}return!1},clearRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!");rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!",5);var a=rspkr.HL.Restore.Storage,
d=[],b=[],c=/sync_(word|sent|user)/gi,e=a.restoreContent;0===a.readClass.length&&0===a.readId.length&&rspkr.HL.Restore.getReadData();if(0<a.readClass.length)for(var f=0;f<a.readClass.length;f++)d.push($rs.get("."+a.readClass[f]));else if(0<a.readId.length)for(f=0;f<a.readId.length;f++){for(var h=0;h<a.readId[f].length;h++)b.push($rs.get("#"+a.readId[f][h]));d.push(b);b=[]}else rspkr.log("ERR: Could not set restore content or find the read area data",3);a.restoreContent=[];for(f=0;f<d.length;f++){for(h=
0;h<d[f].length;h++)!1===c.test(d[f][h].innerHTML)?(rspkr.log("1",5),b.push(d[f][h].innerHTML)):0<e.length?(rspkr.log("2",5),b.push(e[f][h])):(rspkr.log("3",5),b.push(d[f][h].innerHTML));a.restoreContent.push(b);b=[]}},getReadData:function(){rspkr.log("[rspkr.HL.Restore.getReadData]");for(var a=$rs.get("a"),b=0,c=a.length;b<c;b++)if(a[b].getAttribute("href")&&-1!==a[b].getAttribute("href").indexOf(rspkr.cfg.item("general.domain")+"/cgi-bin/"+rspkr.cfg.item("general.rsent"))&&"rsSaveBtn"!==a[idx].id&&
"rs_selimg"!==a[idx].id)if(-1!==a[b].getAttribute("href").search(/readclass=/)){var e=a[b].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=","");rspkr.HL.Restore.Storage.readClass.push(e)}else if(-1!==a[b].getAttribute("href").search(/readid=/)){for(var e=a[b].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=","").split(","),f=[],n=0;n<e.length;n++)f.push(e[n]);rspkr.HL.Restore.Storage.readId.push(f)}}},Scroll:{currentSpan:null,timer:null,useScroll:!1,userScrollTimer:null,
stopped:!0,getScrollY:function(){var a=0;"number"==typeof document.pageYOffset?a=document.pageYOffset:document.documentElement&&document.documentElement.scrollTop&&0<document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&document.body.scrollTop&&(a=document.body.scrollTop);return a},getWindowHeight:function(){var a=0;"number"==typeof window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&0<document.documentElement.clientHeight?
a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight);return a+30},userScroll:function(){rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.userScrollTimer&&clearTimeout(rspkr.HL.Scroll.userScrollTimer);rspkr.HL.Scroll.userScrollTimer=setTimeout(function(){rspkr.HL.Scroll.userScrollTimer=null},5E3)},stopTimer:function(){rspkr.log("[rspkr.Hl.Scroll.stopTimer] Called!");rspkr.HL.Scroll.timer&&
(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.stopped=!0},initScroll:function(){"scrollon"==rspkr.Common.Settings.get("hlscroll")?(rspkr.log("[rspkr.HL.Sroll.initScroll] Scroll initiated!"),rspkr.HL.Scroll.useScroll=!0,rspkr.evt("onUIClosePlayer",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIStop",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIPause",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUISliderMove",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusIn",rspkr.HL.Scroll.userScroll),
rspkr.evt("onFocusOut",rspkr.HL.Scroll.userScroll),document.addEventListener?document.addEventListener("scroll",function(){setTimeout(function(){rspkr.HL.Scroll.userScroll()},0)},!1):document.attachEvent?document.attachEvent("onscroll",rspkr.HL.Scroll.userScroll):document.onscroll=rspkr.HL.Scroll.userScroll):this.useScroll=!1},execScroll:function(a){this.useScroll&&(this.currentSpan=a,!0===this.stopped&&(this.stopped=!1),this.timer||(rspkr.log("[rspkr.hl.Scroll] execScroll"),this.timer=setTimeout(function(){rspkr.HL.Scroll.timer=
null;rspkr.HL.Scroll.triggerScroll(rspkr.HL.Scroll.currentSpan)},500)))},triggerScroll:function(a){rspkr.log("[rspkr.HL.Scroll.triggerScroll] timer: "+rspkr.hl.Scroll.userScrollTimer+", stopped: "+rspkr.HL.Scroll.stopped);!rspkr.HL.Scroll.userScrollTimer&&!1===rspkr.HL.Scroll.stopped&&rspkr.u.scroll.scrollToElm(a)}},State:{CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(a){this.CURRENT=a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},
sync:{init:function(){rspkr.log("[rspkr.hl.sync.init]",5);rspkr.Common.dispatchEvent("onBeforeSyncInit",window);e.hlChanged=!1;if(0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)rspkr.log("[rspkr.HL._sync.init] client markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.CLIENT_MARKUP,b.firstRun=1,"explorer"==c?document.selection.empty():b.preProcess.identifyElementsReplacementNode(document.body);else if(rspkr.log("[rspkr.HL._sync.init] server markup"),rspkr.HL.Type.CURRENT=
rspkr.HL.Type.SERVER_MARKUP,"none"!=rspkr.Common.data.sync){var a=[],d=[],f=document.createElement("DIV");f.innerHTML=rspkr.HL.markedUpHTML;if(rspkr.c.data.params.hasOwnProperty("readclass"))d=$rs.findIn(f,"."+rspkr.c.data.params.readclass),a=$rs.get("."+rspkr.c.data.params.readclass);else if(rspkr.c.data.params.hasOwnProperty("readid"))for(var m=rspkr.c.data.params.readid.split(","),g=0;g<m.length;g++){var n=$rs.findIn(f,"#"+m[g]);$rs.isArray(n)&&0===n.length?d.push(f):d.push(n);a.push($rs.get("#"+
m[g]))}rspkr.log("[rspkr.HL.sync.init] readElements length: "+a.length);for(g=0;g<a.length;g++)rspkr.HL.Preserve.moveToShelter(a[g]),a[g].innerHTML=d[g].innerHTML,rspkr.HL.Preserve.restoreFromShelter(a[g]);rspkr.HL.Preserve.clearShelter()}rspkr.HL.markedUpHTML="";rspkr.Common.post.removeIframe();rspkr.Common.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.log("[rspkr.HL._sync.lightCleanUp] Called! "+rspkr.HL.Type.CURRENT);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&
!0===e.hlChanged?b.postProcess.settingsCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!1===e.hlChanged||0<rspkr.Common.data.selectedText.length?b.postProcess.lightCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&f.postProcess.lightCleanUp()},fullCleanUp:function(){rspkr.log("[rspkr.HL._sync.fullCleanUp] Called!");rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&b.postProcess.lightCleanUp();f.postProcess.fullCleanUp()},setId:function(){rspkr.log("[rspkr.HL._sync.setId] Called!")},
setContent:function(a){rspkr.log("[rspkr.HL._sync.setContent] Called!");rspkr.HL.markedUpHTML+=a},execute:function(a,b){var c=rspkr.Common.Settings;if(!("none"===c.get("hl")||"hloff"===c.get("hltoggle"))){if(rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP){var e=$rs.hasClass($rs.get("#sync"+b),"sync_sent")?"sent":"word";if("sent"===c.get("hl")&&"word"===e||"word"===c.get("hl")&&"sent"===e)return}rspkr.Common.dispatchEvent("onBeforeSync",window);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP?
rspkr.HL.clientMarkup.sync(a,b):rspkr.HL.serverMarkup.sync(a,b);rspkr.Common.dispatchEvent("onAfterSync",window)}}},settings:e,Type:{CURRENT:0,DEFAULT:0,SERVER_MARKUP:1,CLIENT_MARKUP:2}}}();rspkr.HL.engine||(rspkr.HL.engine={});
rspkr.HL.engine.explorer=function(){return{clientExtension:{firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[],preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,exludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;rspkr.Common.data.selectedHTML=this.buildMarkup(rspkr.Common.data.selectedRange)},
buildMarkup:function(c){var b=c.duplicate(),f=0,e="",a=1,d=0,k=0,m="",g="";c.moveStart("word",-1);c.moveStart("word",1);b.isEqual(c)||c.moveStart("word",-1);b=c.duplicate();c.moveEnd("word",1);c.moveEnd("word",-1);b.isEqual(c)||c.moveEnd("word",1);var n=c.parentElement(),h=c.duplicate();h.collapse(!1);b=c.duplicate();for(b.collapse();c.inRange(b)&&0!=c.compareEndPoints("EndToEnd",b);){k++;f++;if(1E4<f)break;b.collapse(!1);b.expand("word",1);g=m="";h.collapse(!1);var p=b.duplicate();p.collapse(!1);
if(0==h.compareEndPoints("StartToStart",p)&&0==h.compareEndPoints("EndToEnd",p)&&p.htmlText==h.htmlText){d++;if(2>d)b.move("character",1);else if(4>d)b.move("character",2);else if(6>d)b.move("word",1);else if(8>d)b.move("word",2);else if(10>d)b.move("sentence",1);else if(12>d)b.move("sentence",2);else break;b.collapse(!1)}else{d=0;if(-1===k)return b;rspkr.HL.clientMarkup.selectedWordsRange[k]=b.duplicate();h=b.text;p=b.htmlText;b.collapse(!1);var r;1===a?(lastPos=b.duplicate(),r=this.iterateParentTree(lastPos.parentElement(),
document.body,n,0)):r=this.iterateParentTree(b.parentElement(),lastPos.parentElement(),n,0);for(var s=this.iterateParentTree(lastPos.parentElement(),b.parentElement(),n,0),l=b.parentElement(),q=0;q<r&&20>q;q++)l.className.match("sync_")||(m=l.outerHTML.match("<[^>]*>")[0]+m),l=l.parentElement;l=lastPos.parentElement();for(q=0;q<s&&20>q;q++)l.className.match("sync_")||(g+="</"+l.tagName+">"),l=l.parentElement;if(0!=r||0!=s)lastPos=b.duplicate();1===a?(e+=m,a=0):e+=g+m;""!=p.replace("sync_sent_highlighted",
"")&&(e+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user" id="sync'+k+'">'+h+"</"+rspkr.Common.data.browser.syncContainer+">");h=b.duplicate()}}e+="<\!-- f --\>";s=this.iterateParentTree(lastPos.parentElement(),document.body,n,0);l=lastPos.parentElement();for(q=0;q<s;q++)l.className.match("sync_")||(e+="</"+l.tagName+">"),l=l.parentElement;b.collapse();return e},iterateParentTree:function(c,b,f,e){for(var a=b;null!==a;){if(c==f||c==a)return e;a=a.parentElement}e++;return this.iterateParentTree(c.parentElement,
b,f,e)}},postProcess:{lightCleanUp:function(){rspkr.log("[clientMarkup.postProcess.lightCleanUp] called!");for(var c=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer),b=c.length-1;-1<b;b--)c[b].className=c[b].className.replace("sync_sent_highlighted","sync_sent"),c[b].className=c[b].className.replace("sync_word_highlighted","sync_word"),-1===c[b].className.toLowerCase().indexOf("sync_user")&&c[b].removeAttribute("id");var c=rspkr.HL.clientMarkup.previousWord.range,f=rspkr.HL.clientMarkup.previousWord.forecolor,
e=rspkr.HL.clientMarkup.previousWord.backcolor,a=rspkr.HL.clientMarkup.previousSent.range,d=rspkr.HL.clientMarkup.previousSent.forecolor,k=rspkr.HL.clientMarkup.previousSent.backcolor;if(0<c.length)for(var b=0;b<c.length;b++)e[b]&&(c[b].execCommand("backcolor",0,e[b]),f[b]&&c[b]&&c[b].execCommand("forecolor",0,f[b]));if(0<a.length)for(b=0;b<a.length;b++)k[b]&&(a[b].execCommand("backcolor",0,k[b]),d[b]&&a[b]&&a[b].execCommand("forecolor",0,d[b]))},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");
this.lightCleanUp();this.selectedWordsRange=[]}},sync:function(c,b){var f=!1,e;0===(c&2)&&(f=0!=(c&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]);e=this.selectedWordsRange[b];if(1===this.firstRun){this.firstRun=0;if(0<this.previousSent.range.length){for(var a=0;a<this.previousSent.range.length;a++)this.previousSent.range[a].execCommand("backcolor",
0,this.previousSent.backcolor[a]),null!==this.previousSent.forecolor[a]&&this.previousSent.range[a].execCommand("forecolor",0,this.previousSent.forecolor[a]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=[]}if(this.selectedWordsRange&&0<this.selectedWordsRange.length&&"wordsent"===rspkr.st.get("hl"))for(a=0;a<this.selectedWordsRange.length;a++)this.selectedWordsRange[a]&&(this.previousSent.range.push(this.selectedWordsRange[a]),this.previousSent.backcolor.push(this.selectedWordsRange[a].queryCommandValue("backcolor")),
this.previousSent.forecolor.push(this.selectedWordsRange[a].queryCommandValue("forecolor")),""!=this.selectedWordsRange[a].text&&(this.selectedWordsRange[a].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.selectedWordsRange[a].execCommand("forecolor",0,rspkr.cfg.item("settings.hltext"))))}if(!f&&0<this.previousWord.range.length){for(a=0;a<this.previousWord.range.length;a++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[a].execCommand("backcolor",
0,this.previousWord.backcolor[a]):this.previousWord.range[a].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[a].execCommand("forecolor",0,this.previousWord.forecolor[a]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(e.queryCommandValue("backcolor"));this.previousWord.forecolor.push(e.queryCommandValue("forecolor"));this.previousWord.range.push(e);"sent"==rspkr.st.get("hl")?e.execCommand("backcolor",
0,rspkr.Common.Settings.get("hlsent")):e.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword"));e.execCommand("forecolor",0,rspkr.cfg.item("settings.hltext"))}}}}();
rspkr.HL.engine.gecko=function(){return{clientExtension:{test:"test",preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,exludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;var c="",c=rspkr.Common.data.selectedRange;this.startNode=c.startContainer;this.endNode=c.endContainer;this.startOffset=this.modifyOffsetStartOfWord(this.startNode,
c.startOffset);this.endOffset=this.modifyOffsetEndOfWord(this.endNode,c.endOffset);c=this.buildMarkup(c.commonAncestorContainer);window.getSelection().removeAllRanges();rspkr.Common.data.selectedHTML=c},buildMarkup:function(c){this.firstRun=1;var b="",f=this.inc;if(3==c.nodeType)b+=this.textMarkup(c);else{var e,a="";if(c.hasChildNodes())for(e=0;e<c.childNodes.length;e++){var d=c.childNodes.item(e);d==this.startNode&&(this.inc=1);c==this.startNode&&e==this.startOffset&&(this.inc=1);8!=d.nodeType&&
(a+=this.buildMarkup(d));if(c==this.endNode&&e==this.endOffset){this.inc=0;break}if(d==this.endNode){this.inc=0;break}}(f||this.inc)&&(!c.className||c.className.replace("sync")===c.className&&c.id.replace("sync")===c.id)?(f=document.createElement("div"),f.appendChild(c.cloneNode(!0)),tempdivtag=f.innerHTML.match("<[^>]*>"),null!==tempdivtag&&0<tempdivtag.length?(b+=tempdivtag[0],b=b+a+("</"+c.nodeName+">")):b+=a):b+=a;if(c.hasChildNodes())for(e=0;e<c.childNodes.length;e++){if(c===this.endNode&&e===
this.endOffset){this.inc=0;break}if(d===this.endNode){this.inc=0;break}}}return b},textMarkup:function(c){var b=!0,f="",e,a="",d="",k=c.nodeValue;c===this.startNode&&-1!==this.startOffset&&c===this.endNode&&-1!==this.endOffset?(a=c.nodeValue.substring(0,this.startOffset),k=c.nodeValue.substring(this.startOffset,this.endOffset),d=c.nodeValue.substring(this.endOffset),this.inc=1):c===this.startNode&&-1!==this.startOffset?(a=c.nodeValue.substring(0,this.startOffset),k=c.nodeValue.substring(this.startOffset),
this.inc=1):c===this.endNode&&-1!==this.endOffset&&(k=c.nodeValue.substring(0,this.endOffset),d=c.nodeValue.substring(this.endOffset),this.inc=1);if(!this.inc)return"";for(e=0;e<this.exludednodes.length;e++)if(c.parentNode&&c.parentNode.nodeName.toLowerCase()===this.exludednodes[e]){b=!1;f=this.htmlencode(k);break}b&&(f=this.markupSentences(this.htmlencode(k),null));c===this.endNode&&-1!==this.endOffset&&(this.inc=0);b&&(null!==c.parentNode&&""!==k)&&(b=this.createreplacementnode(a+f+d,getComputedStyle(c.parentNode,
null)),c.parentNode.insertBefore(b,c),c.parentNode.removeChild(c));return f},markupSentences:function(c){c=this.splitString(c,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82")]);if(!c)return"";for(var b="",f=0;f<c.length;f++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',b+=this.markupWords(c[f]),b+="</"+rspkr.Common.data.browser.syncContainer+">";
return b},markupWords:function(c){c=this.splitString(c," ");if(!c)return"";for(var b="",f=0;f<c.length;f++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',b+=' id="sync'+this.bookMarkIndex++ +'">',b+=c[f],b+="</"+rspkr.Common.data.browser.syncContainer+">";return b},trim:function(c){return c.replace(/^\s+|\s+$/g,"")},htmlencode:function(c){var b=document.createElement("div"),c=document.createTextNode(c);b.appendChild(c);return b.innerHTML},
identifyElementsReplacementNode:function(c){c.tagName&&(c.tagName.toLowerCase()==rspkr.Common.data.browser.syncContainer&&c.id)&&(rspkr.HL.clientMarkup.selectedWordsRange[c.id]=c);if(c.hasChildNodes())for(var b=0;b<c.childNodes.length;b++){var f=c.childNodes.item(b);this.identifyElementsReplacementNode(f)}},createreplacementnode:function(c){var b=document.createElement(rspkr.Common.data.browser.syncContainer);b.innerHTML=c;b.setAttribute("class","synctemp cl"+this.numberOfSelections);return b},modifyOffsetStartOfWord:function(c,
b){for(var f=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82")];c.nodeValue&&0!=b;){for(var e=0;e<f.length;e++)if(breakstr=f[e],0==c.nodeValue.substring(b-1).indexOf(breakstr))return b;b--}return b},modifyOffsetEndOfWord:function(c,b){for(var f=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82")];c.nodeValue&&b!=c.nodeValue.length;){for(var e=0;e<f.length;e++)if(breakstr=f[e],0==c.nodeValue.substring(b-1).indexOf(breakstr))return b;
b++}return b},returnClassArraySubstring:function(c){var b=document.getElementsByTagName("*"),f=0,e=[];for(i=0;i<b.length;i++)b[i].className.replace(c,"")!=b[i].className&&(e[f]=b[i],f++);return e},splitString:function(c,b){for(var f=[""],e=0,a=0;a<c.length;a++){for(var d=0;d<b.length;d++){for(var k=b[d],m=!0,g=0;g<k.length;g++)if(0>c.length-(a+g)||k[k.length-g-1]!=c[a-g-1]){m=!1;break}m&&(e++,f[e]="")}f[e]+=c[a]}return f}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");
var c=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer),b;for(i=c.length-1;-1<i;i--){b=document.createDocumentFragment();for(j=0;j<c[i].childNodes.length;j++)b.appendChild(c[i].childNodes[j].cloneNode(!0));c[i].parentNode.replaceChild(b,c[i])}},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var c=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer);for(i=c.length-1;-1<i;i--)c[i].className=c[i].className.replace("sync_sent_highlighted",
"sync_sent"),c[i].className=c[i].className.replace("sync_word_highlighted","sync_word"),-1===c[i].className.toLowerCase().indexOf("sync_user")&&c[i].removeAttribute("id")},settingsCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.settingsCleanUp] called!");var c=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,f=rspkr.HL.clientMarkup.previousSent.element,e=rspkr.HL.clientMarkup.previousSent.className;if(0<c.length){for(var a in c)c[a].className=b[a];
rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<f.length){for(a in f)f[a].className=e[a];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");var c=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,f=rspkr.HL.clientMarkup.previousSent.element,e=rspkr.HL.clientMarkup.previousSent.className;
if(0<c.length){for(var a in c)c[a].className=b[a];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<f.length){for(a in f)f[a].className=e[a];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}rspkr.Common.data.selectedHTML=""}},sync:function(c,b){rspkr.log("clientSync "+rspkr.HL.clientMarkup.selectedWordsRange.length);var f=!1,e;0==(c&2)&&(f=0!=(c&1)?!0:!1);1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=
[],this.previousSent.element=[],this.previousSent.className=[]);e=this.selectedWordsRange["sync"+b];rspkr.log(e.className);if(e.className.replace("word","")!=e.className){rspkr.log("inside");if(0<this.previousWord.element.length&&0<this.previousWord.className.length&&!f){for(f=0;f<this.previousWord.element.length;f++)this.previousWord.element[f].className=this.previousWord.className[f];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(e);this.previousWord.className.push(e.className);
e.className="sent"===rspkr.st.get("hl")?"sync_user sync_sent_highlighted":"sync_user sync_word_highlighted"}e&&rspkr.HL.Scroll.execScroll(e);if(1==this.firstRun){this.firstRun=0;if(0<this.previousSent.element.length){for(f=0;f<this.previousSent.element.length;f++)this.previousSent.element[f].className=this.previousSent.className[f];this.previousSent.element=[];this.previousSent.className=[]}if("wordsent"==rspkr.st.get("hl")){e=this.preProcess.returnClassArraySubstring("ffsent"+this.preProcess.numberOfSelections+
" ");for(f=0;f<e.length;f++)this.previousSent.element[f]=e[f],this.previousSent.className[f]=e[f].className,e[f].className="ffsent"+this.preProcess.numberOfSelections+" sync_sent_highlighted"}}}}}}();
