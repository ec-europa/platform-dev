@api
Feature: Xss Vulnerability
  In order to control the xss vulnerability
  As an Administrator
  I need to test xss vulnerability in the platform

  Background:
    Given I am logged in as a user with the 'administrator' role

  @javascript @api
  Scenario: Test the caption field of an Image Field.
    When I go to "node/add/article"
    And I fill in "Title" with "Article with xss Code in an image"
    And I attach the file "/tests/files/logo.png" to "edit-field-image-und-0-upload"
    And I press "Save"
    Then the response should contain "has been created."
    When I go to "/admin/content/file"
    And I click "logo.png"
    And I click "Edit"
    And I fill in "Name" with "test_xss.png"
    And I fill in "Caption" with "<script>alert('xss alert');</script>"
    And I press "Save"
    And the response should contain "has been updated."
    When I go to "/admin/content"
    And the cache has been cleared
    And I click "Article with xss Code in an image"
    And the response should contain "&lt;script&gt;alert('xss alert');&lt;/script&gt;"
    And the response should not contain "<script>alert('xss alert');</script>"
